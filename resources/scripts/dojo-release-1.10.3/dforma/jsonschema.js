//>>built
define("dforma/jsonschema",["dojo/_base/lang","dojo/_base/array","dforma/util/string/toProperCase"],function(l,n){var m=l.getObject("dforma.jsonschema",!0);l.mixin(m,{schemasToController:function(k,g,c){c||(c={});var f=l.mixin({type:"select",required:!0,controller:!0,searchAttr:"label",options:[]},c.controller?c.controller:{});c.add&&(c.edit=!0,c["delete"]=!0,f.editControls=c.editControls);n.forEach(k,function(d,a){d["default"]&&(f["default"]=d["default"]);var e=c.titleProperty||"title",b=c.idProperty||
"id",h=d[b]?d[b]:a,e=d[e]?d[e]:d[b]?h.toProperCase():"item"+a,h={id:h,label:e,schema:d,controls:m.schemaToControls(d,g,c)};if(!0===c.edit||!0===c["delete"])h.name=d[f.name],h.id=d[b],h.properties=d.properties;f.options.push(h)});g&&g[f.name]?f.value=g[f.name]:c.selectFirst&&(f.value=f.options[0].id);return f},schemaToControls:function(k,g,c){c=c||{};k=k.properties;var f=[],d;for(d in k){var a=k[d],e;e="boolean"==a.type?"checkbox":"integer"==a.type?"spinner":"number"==a.type?"currency"==a.format?"currency":
"number":"date"==a.type?"date":"array"==a.type||a.hasOwnProperty("enum")||a.hasOwnProperty("oneOf")?"list"==a.format?"list":"select"==a.format?"select":"radiogroup"==a.format?"radiogroup":"repeat":"object"==a.type?"group":"string"==a.type&&"text"==a.format?"textarea":"email"==a.format?"email":"phone"==a.format?"phone":"input";var b={name:d,type:e,schema:a,required:!0===a.required,readonly:!0===a.readonly};"currency"==e&&(b.currency=a.currency||"EUR");a.hasOwnProperty("invalidMessage")&&(b.invalidMessage=
a.invalidMessage);if(a.hasOwnProperty("minimum")||a.hasOwnProperty("maximum"))b.constraints={},a.hasOwnProperty("minimum")&&(b.constraints.min=a.minimum),a.hasOwnProperty("maximum")&&(b.constraints.max=a.maximum);a.hasOwnProperty("title")&&(b.title=a.title);a.hasOwnProperty("description")&&(b.description=a.description);"list"==e&&(b.columns=a.columns,b.controller=a.controller);if("select"==e||"radiogroup"==e)b.options=[],a.hasOwnProperty("enum")?n.forEach(a["enum"],function(a){b.options.push({id:a})}):
a.hasOwnProperty("oneOf")&&(b.options=a.oneOf);"checkbox"==e&&a.hasOwnProperty("enum")&&(b.isValid=a["enum"]);if("repeat"==e||"group"==e)e=m.schemasToController([{properties:"repeat"==e?a.items:a.properties}],null,{controller:{type:e,name:b.name}}),b=l.mixin(b,e);"hidden"==a.format&&(b.hidden=!0);a.dialog&&(b.dialog=a.dialog);"unhidebutton"==a.format&&(b.type="unhidebutton",a.target&&(b.target=a.target));c.hasOwnProperty("edit")&&!0===c.edit&&(b.edit=!0,b.editControls=c.editControls);c.hasOwnProperty("delete")&&
!0===c["delete"]&&(b["delete"]=!0);c.hasOwnProperty("descriptionProperty")&&(b.description=a[c.descriptionProperty]);g&&g.hasOwnProperty(d)?b.value=g[d]:a.hasOwnProperty("default")&&(b.value=a["default"]);f.push(b)}return f}});return m});
//# sourceMappingURL=jsonschema.js.map